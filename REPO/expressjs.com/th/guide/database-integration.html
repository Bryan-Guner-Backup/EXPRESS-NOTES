<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="th" xml:lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Express database integration</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Express database integration</h1>
</header>
<h1 id="database-integration">Database integration</h1>
<p>Adding the capability to connect databases to Express apps is just a matter of loading an appropriate Node.js driver for the database in your app. This document briefly explains how to add and use some of the most popular Node.js modules for database systems in your Express app:</p>
<ul>
<li><a href="#cassandra">Cassandra</a></li>
<li><a href="#couchbase">Couchbase</a></li>
<li><a href="#couchdb">CouchDB</a></li>
<li><a href="#leveldb">LevelDB</a></li>
<li><a href="#mysql">MySQL</a></li>
<li><a href="#mongodb">MongoDB</a></li>
<li><a href="#neo4j">Neo4j</a></li>
<li><a href="#oracle">Oracle</a></li>
<li><a href="#postgresql">PostgreSQL</a></li>
<li><a href="#redis">Redis</a></li>
<li><a href="#sql-server">SQL Server</a></li>
<li><a href="#sqlite">SQLite</a></li>
<li><a href="#elasticsearch">ElasticSearch</a></li>
</ul>
<div class="doc-box doc-notice" data-markdown="1">
<p>These database drivers are among many that are available. For other options, search on the <a href="https://www.npmjs.com/">npm</a> site.</p>
</div>
<h2 id="cassandra">Cassandra</h2>
<p><strong>Module</strong>: <a href="https://github.com/datastax/nodejs-driver">cassandra-driver</a></p>
<h3 id="installation">Installation</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb1-1" title="1">$ <span class="ex">npm</span> install cassandra-driver</a></code></pre></div>
<h3 id="example">Example</h3>
<div class="sourceCode" id="cb2"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">var</span> cassandra <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;cassandra-driver&#39;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">var</span> client <span class="op">=</span> <span class="kw">new</span> <span class="va">cassandra</span>.<span class="at">Client</span>(<span class="op">{</span> <span class="dt">contactPoints</span><span class="op">:</span> [<span class="st">&#39;localhost&#39;</span>] <span class="op">}</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="va">client</span>.<span class="at">execute</span>(<span class="st">&#39;select key from system.local&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> result) <span class="op">{</span></a>
<a class="sourceLine" id="cb2-5" title="5">  <span class="cf">if</span> (err) <span class="cf">throw</span> err</a>
<a class="sourceLine" id="cb2-6" title="6">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">result</span>.<span class="at">rows</span>[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb2-7" title="7"><span class="op">}</span>)</a></code></pre></div>
<h2 id="couchbase">Couchbase</h2>
<p><strong>Module</strong>: <a href="https://github.com/couchbase/couchnode">couchnode</a></p>
<h3 id="installation-1">Installation</h3>
<div class="sourceCode" id="cb3"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb3-1" title="1">$ <span class="ex">npm</span> install couchbase</a></code></pre></div>
<h3 id="example-1">Example</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">var</span> couchbase <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;couchbase&#39;</span>)</a>
<a class="sourceLine" id="cb4-2" title="2"><span class="kw">var</span> bucket <span class="op">=</span> (<span class="kw">new</span> <span class="va">couchbase</span>.<span class="at">Cluster</span>(<span class="st">&#39;http://localhost:8091&#39;</span>)).<span class="at">openBucket</span>(<span class="st">&#39;bucketName&#39;</span>)</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co">// add a document to a bucket</span></a>
<a class="sourceLine" id="cb4-5" title="5"><span class="va">bucket</span>.<span class="at">insert</span>(<span class="st">&#39;document-key&#39;</span><span class="op">,</span> <span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;Matt&#39;</span><span class="op">,</span> <span class="dt">shoeSize</span><span class="op">:</span> <span class="dv">13</span> <span class="op">},</span> <span class="kw">function</span> (err<span class="op">,</span> result) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-6" title="6">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-7" title="7">    <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb4-8" title="8">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(result)</a>
<a class="sourceLine" id="cb4-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb4-11" title="11"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">// get all documents with shoe size 13</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="kw">var</span> n1ql <span class="op">=</span> <span class="st">&#39;SELECT d.* FROM `bucketName` d WHERE shoeSize = $1&#39;</span></a>
<a class="sourceLine" id="cb4-15" title="15"><span class="kw">var</span> query <span class="op">=</span> <span class="va">N1qlQuery</span>.<span class="at">fromString</span>(n1ql)</a>
<a class="sourceLine" id="cb4-16" title="16"><span class="va">bucket</span>.<span class="at">query</span>(query<span class="op">,</span> [<span class="dv">13</span>]<span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> result) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-17" title="17">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb4-18" title="18">    <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb4-19" title="19">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb4-20" title="20">    <span class="va">console</span>.<span class="at">log</span>(result)</a>
<a class="sourceLine" id="cb4-21" title="21">  <span class="op">}</span></a>
<a class="sourceLine" id="cb4-22" title="22"><span class="op">}</span>)</a></code></pre></div>
<h2 id="couchdb">CouchDB</h2>
<p><strong>Module</strong>: <a href="https://github.com/dscape/nano">nano</a></p>
<h3 id="installation-2">Installation</h3>
<div class="sourceCode" id="cb5"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb5-1" title="1">$ <span class="ex">npm</span> install nano</a></code></pre></div>
<h3 id="example-2">Example</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">var</span> nano <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;nano&#39;</span>)(<span class="st">&#39;http://localhost:5984&#39;</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="va">nano</span>.<span class="va">db</span>.<span class="at">create</span>(<span class="st">&#39;books&#39;</span>)</a>
<a class="sourceLine" id="cb6-3" title="3"><span class="kw">var</span> books <span class="op">=</span> <span class="va">nano</span>.<span class="va">db</span>.<span class="at">use</span>(<span class="st">&#39;books&#39;</span>)</a>
<a class="sourceLine" id="cb6-4" title="4"></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">// Insert a book document in the books database</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="va">books</span>.<span class="at">insert</span>(<span class="op">{</span> <span class="dt">name</span><span class="op">:</span> <span class="st">&#39;The Art of war&#39;</span> <span class="op">},</span> <span class="kw">null</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> body) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-7" title="7">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-8" title="8">    <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb6-9" title="9">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-10" title="10">    <span class="va">console</span>.<span class="at">log</span>(body)</a>
<a class="sourceLine" id="cb6-11" title="11">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb6-13" title="13"></a>
<a class="sourceLine" id="cb6-14" title="14"><span class="co">// Get a list of all books</span></a>
<a class="sourceLine" id="cb6-15" title="15"><span class="va">books</span>.<span class="at">list</span>(<span class="kw">function</span> (err<span class="op">,</span> body) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-16" title="16">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb6-17" title="17">    <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb6-18" title="18">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb6-19" title="19">    <span class="va">console</span>.<span class="at">log</span>(<span class="va">body</span>.<span class="at">rows</span>)</a>
<a class="sourceLine" id="cb6-20" title="20">  <span class="op">}</span></a>
<a class="sourceLine" id="cb6-21" title="21"><span class="op">}</span>)</a></code></pre></div>
<h2 id="leveldb">LevelDB</h2>
<p><strong>Module</strong>: <a href="https://github.com/rvagg/node-levelup">levelup</a></p>
<h3 id="installation-3">Installation</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb7-1" title="1">$ <span class="ex">npm</span> install level levelup leveldown</a></code></pre></div>
<h3 id="example-3">Example</h3>
<div class="sourceCode" id="cb8"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">var</span> levelup <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;levelup&#39;</span>)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw">var</span> db <span class="op">=</span> <span class="at">levelup</span>(<span class="st">&#39;./mydb&#39;</span>)</a>
<a class="sourceLine" id="cb8-3" title="3"></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="va">db</span>.<span class="at">put</span>(<span class="st">&#39;name&#39;</span><span class="op">,</span> <span class="st">&#39;LevelUP&#39;</span><span class="op">,</span> <span class="kw">function</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="cf">if</span> (err) <span class="cf">return</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Ooops!&#39;</span><span class="op">,</span> err)</a>
<a class="sourceLine" id="cb8-6" title="6"></a>
<a class="sourceLine" id="cb8-7" title="7">  <span class="va">db</span>.<span class="at">get</span>(<span class="st">&#39;name&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> value) <span class="op">{</span></a>
<a class="sourceLine" id="cb8-8" title="8">    <span class="cf">if</span> (err) <span class="cf">return</span> <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Ooops!&#39;</span><span class="op">,</span> err)</a>
<a class="sourceLine" id="cb8-9" title="9"></a>
<a class="sourceLine" id="cb8-10" title="10">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;name=&#39;</span> <span class="op">+</span> value)</a>
<a class="sourceLine" id="cb8-11" title="11">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb8-12" title="12"><span class="op">}</span>)</a></code></pre></div>
<h2 id="mysql">MySQL</h2>
<p><strong>Module</strong>: <a href="https://github.com/felixge/node-mysql/">mysql</a></p>
<h3 id="installation-4">Installation</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb9-1" title="1">$ <span class="ex">npm</span> install mysql</a></code></pre></div>
<h3 id="example-4">Example</h3>
<div class="sourceCode" id="cb10"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">var</span> mysql <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;mysql&#39;</span>)</a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw">var</span> connection <span class="op">=</span> <span class="va">mysql</span>.<span class="at">createConnection</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb10-3" title="3">  <span class="dt">host</span><span class="op">:</span> <span class="st">&#39;localhost&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-4" title="4">  <span class="dt">user</span><span class="op">:</span> <span class="st">&#39;dbuser&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-5" title="5">  <span class="dt">password</span><span class="op">:</span> <span class="st">&#39;s3kreee7&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb10-6" title="6">  <span class="dt">database</span><span class="op">:</span> <span class="st">&#39;my_db&#39;</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="va">connection</span>.<span class="at">connect</span>()</a>
<a class="sourceLine" id="cb10-10" title="10"></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="va">connection</span>.<span class="at">query</span>(<span class="st">&#39;SELECT 1 + 1 AS solution&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> rows<span class="op">,</span> fields) <span class="op">{</span></a>
<a class="sourceLine" id="cb10-12" title="12">  <span class="cf">if</span> (err) <span class="cf">throw</span> err</a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;The solution is: &#39;</span><span class="op">,</span> rows[<span class="dv">0</span>].<span class="at">solution</span>)</a>
<a class="sourceLine" id="cb10-15" title="15"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb10-16" title="16"></a>
<a class="sourceLine" id="cb10-17" title="17"><span class="va">connection</span>.<span class="at">end</span>()</a></code></pre></div>
<h2 id="mongodb">MongoDB</h2>
<p><strong>Module</strong>: <a href="https://github.com/mongodb/node-mongodb-native">mongodb</a></p>
<h3 id="installation-5">Installation</h3>
<div class="sourceCode" id="cb11"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb11-1" title="1">$ <span class="ex">npm</span> install mongodb</a></code></pre></div>
<h3 id="example-5">Example</h3>
<div class="sourceCode" id="cb12"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">var</span> MongoClient <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;mongodb&#39;</span>).<span class="at">MongoClient</span></a>
<a class="sourceLine" id="cb12-2" title="2"></a>
<a class="sourceLine" id="cb12-3" title="3"><span class="va">MongoClient</span>.<span class="at">connect</span>(<span class="st">&#39;mongodb://localhost:27017/animals&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> db) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-4" title="4">  <span class="cf">if</span> (err) <span class="cf">throw</span> err</a>
<a class="sourceLine" id="cb12-5" title="5"></a>
<a class="sourceLine" id="cb12-6" title="6">  <span class="va">db</span>.<span class="at">collection</span>(<span class="st">&#39;mammals&#39;</span>).<span class="at">find</span>().<span class="at">toArray</span>(<span class="kw">function</span> (err<span class="op">,</span> result) <span class="op">{</span></a>
<a class="sourceLine" id="cb12-7" title="7">    <span class="cf">if</span> (err) <span class="cf">throw</span> err</a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(result)</a>
<a class="sourceLine" id="cb12-10" title="10">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="op">}</span>)</a></code></pre></div>
<p>If you want an object model driver for MongoDB, look at <a href="https://github.com/LearnBoost/mongoose">Mongoose</a>.</p>
<h2 id="neo4j">Neo4j</h2>
<p><strong>Module</strong>: <a href="https://github.com/hacksparrow/apoc">apoc</a></p>
<h3 id="installation-6">Installation</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb13-1" title="1">$ <span class="ex">npm</span> install apoc</a></code></pre></div>
<h3 id="example-6">Example</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">var</span> apoc <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;apoc&#39;</span>)</a>
<a class="sourceLine" id="cb14-2" title="2"></a>
<a class="sourceLine" id="cb14-3" title="3"><span class="va">apoc</span>.<span class="at">query</span>(<span class="st">&#39;match (n) return n&#39;</span>).<span class="at">exec</span>().<span class="at">then</span>(</a>
<a class="sourceLine" id="cb14-4" title="4">  <span class="kw">function</span> (response) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-5" title="5">    <span class="va">console</span>.<span class="at">log</span>(response)</a>
<a class="sourceLine" id="cb14-6" title="6">  <span class="op">},</span></a>
<a class="sourceLine" id="cb14-7" title="7">  <span class="kw">function</span> (fail) <span class="op">{</span></a>
<a class="sourceLine" id="cb14-8" title="8">    <span class="va">console</span>.<span class="at">log</span>(fail)</a>
<a class="sourceLine" id="cb14-9" title="9">  <span class="op">}</span></a>
<a class="sourceLine" id="cb14-10" title="10">)</a></code></pre></div>
<h2 id="oracle">Oracle</h2>
<p><strong>Module</strong>: <a href="https://github.com/oracle/node-oracledb">oracledb</a></p>
<h3 id="installation-7">Installation</h3>
<p>NOTE: <a href="https://github.com/oracle/node-oracledb#-installation">See installation prerequisites</a>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb15-1" title="1">$ <span class="ex">npm</span> install oracledb</a></code></pre></div>
<h3 id="example-7">Example</h3>
<div class="sourceCode" id="cb16"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">const</span> oracledb <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;oracledb&#39;</span>)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">const</span> config <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-3" title="3">  <span class="dt">user</span><span class="op">:</span> <span class="st">&#39;&lt;your db user&gt;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-4" title="4">  <span class="dt">password</span><span class="op">:</span> <span class="st">&#39;&lt;your db password&gt;&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-5" title="5">  <span class="dt">connectString</span><span class="op">:</span> <span class="st">&#39;localhost:1521/orcl&#39;</span></a>
<a class="sourceLine" id="cb16-6" title="6"><span class="op">}</span></a>
<a class="sourceLine" id="cb16-7" title="7"></a>
<a class="sourceLine" id="cb16-8" title="8"><span class="kw">async</span> <span class="kw">function</span> <span class="at">getEmployee</span> (empId) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-9" title="9">  <span class="kw">let</span> conn</a>
<a class="sourceLine" id="cb16-10" title="10"></a>
<a class="sourceLine" id="cb16-11" title="11">  <span class="cf">try</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-12" title="12">    conn <span class="op">=</span> <span class="cf">await</span> <span class="va">oracledb</span>.<span class="at">getConnection</span>(config)</a>
<a class="sourceLine" id="cb16-13" title="13"></a>
<a class="sourceLine" id="cb16-14" title="14">    <span class="kw">const</span> result <span class="op">=</span> <span class="cf">await</span> <span class="va">conn</span>.<span class="at">execute</span>(</a>
<a class="sourceLine" id="cb16-15" title="15">      <span class="st">&#39;select * from employees where employee_id = :id&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb16-16" title="16">      [empId]</a>
<a class="sourceLine" id="cb16-17" title="17">    )</a>
<a class="sourceLine" id="cb16-18" title="18"></a>
<a class="sourceLine" id="cb16-19" title="19">    <span class="va">console</span>.<span class="at">log</span>(<span class="va">result</span>.<span class="at">rows</span>[<span class="dv">0</span>])</a>
<a class="sourceLine" id="cb16-20" title="20">  <span class="op">}</span> <span class="cf">catch</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb16-21" title="21">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Ouch!&#39;</span><span class="op">,</span> err)</a>
<a class="sourceLine" id="cb16-22" title="22">  <span class="op">}</span> <span class="cf">finally</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb16-23" title="23">    <span class="cf">if</span> (conn) <span class="op">{</span> <span class="co">// conn assignment worked, need to close</span></a>
<a class="sourceLine" id="cb16-24" title="24">      <span class="cf">await</span> <span class="va">conn</span>.<span class="at">close</span>()</a>
<a class="sourceLine" id="cb16-25" title="25">    <span class="op">}</span></a>
<a class="sourceLine" id="cb16-26" title="26">  <span class="op">}</span></a>
<a class="sourceLine" id="cb16-27" title="27"><span class="op">}</span></a>
<a class="sourceLine" id="cb16-28" title="28"></a>
<a class="sourceLine" id="cb16-29" title="29"><span class="at">getEmployee</span>(<span class="dv">101</span>)</a></code></pre></div>
<h2 id="postgresql">PostgreSQL</h2>
<p><strong>Module</strong>: <a href="https://github.com/vitaly-t/pg-promise">pg-promise</a></p>
<h3 id="installation-8">Installation</h3>
<div class="sourceCode" id="cb17"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" title="1">$ <span class="ex">npm</span> install pg-promise</a></code></pre></div>
<h3 id="example-8">Example</h3>
<div class="sourceCode" id="cb18"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">var</span> pgp <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;pg-promise&#39;</span>)(<span class="co">/* options */</span>)</a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">var</span> db <span class="op">=</span> <span class="at">pgp</span>(<span class="st">&#39;postgres://username:password@host:port/database&#39;</span>)</a>
<a class="sourceLine" id="cb18-3" title="3"></a>
<a class="sourceLine" id="cb18-4" title="4"><span class="va">db</span>.<span class="at">one</span>(<span class="st">&#39;SELECT $1 AS value&#39;</span><span class="op">,</span> <span class="dv">123</span>)</a>
<a class="sourceLine" id="cb18-5" title="5">  .<span class="at">then</span>(<span class="kw">function</span> (data) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-6" title="6">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;DATA:&#39;</span><span class="op">,</span> <span class="va">data</span>.<span class="at">value</span>)</a>
<a class="sourceLine" id="cb18-7" title="7">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb18-8" title="8">  .<span class="at">catch</span>(<span class="kw">function</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb18-9" title="9">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;ERROR:&#39;</span><span class="op">,</span> error)</a>
<a class="sourceLine" id="cb18-10" title="10">  <span class="op">}</span>)</a></code></pre></div>
<h2 id="redis">Redis</h2>
<p><strong>Module</strong>: <a href="https://github.com/mranney/node_redis">redis</a></p>
<h3 id="installation-9">Installation</h3>
<div class="sourceCode" id="cb19"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" title="1">$ <span class="ex">npm</span> install redis</a></code></pre></div>
<h3 id="example-9">Example</h3>
<div class="sourceCode" id="cb20"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">var</span> redis <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;redis&#39;</span>)</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="kw">var</span> client <span class="op">=</span> <span class="va">redis</span>.<span class="at">createClient</span>()</a>
<a class="sourceLine" id="cb20-3" title="3"></a>
<a class="sourceLine" id="cb20-4" title="4"><span class="va">client</span>.<span class="at">on</span>(<span class="st">&#39;error&#39;</span><span class="op">,</span> <span class="kw">function</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;Error &#39;</span> <span class="op">+</span> err)</a>
<a class="sourceLine" id="cb20-6" title="6"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb20-7" title="7"></a>
<a class="sourceLine" id="cb20-8" title="8"><span class="va">client</span>.<span class="at">set</span>(<span class="st">&#39;string key&#39;</span><span class="op">,</span> <span class="st">&#39;string val&#39;</span><span class="op">,</span> <span class="va">redis</span>.<span class="at">print</span>)</a>
<a class="sourceLine" id="cb20-9" title="9"><span class="va">client</span>.<span class="at">hset</span>(<span class="st">&#39;hash key&#39;</span><span class="op">,</span> <span class="st">&#39;hashtest 1&#39;</span><span class="op">,</span> <span class="st">&#39;some value&#39;</span><span class="op">,</span> <span class="va">redis</span>.<span class="at">print</span>)</a>
<a class="sourceLine" id="cb20-10" title="10"><span class="va">client</span>.<span class="at">hset</span>([<span class="st">&#39;hash key&#39;</span><span class="op">,</span> <span class="st">&#39;hashtest 2&#39;</span><span class="op">,</span> <span class="st">&#39;some other value&#39;</span>]<span class="op">,</span> <span class="va">redis</span>.<span class="at">print</span>)</a>
<a class="sourceLine" id="cb20-11" title="11"></a>
<a class="sourceLine" id="cb20-12" title="12"><span class="va">client</span>.<span class="at">hkeys</span>(<span class="st">&#39;hash key&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> replies) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-13" title="13">  <span class="va">console</span>.<span class="at">log</span>(<span class="va">replies</span>.<span class="at">length</span> <span class="op">+</span> <span class="st">&#39; replies:&#39;</span>)</a>
<a class="sourceLine" id="cb20-14" title="14"></a>
<a class="sourceLine" id="cb20-15" title="15">  <span class="va">replies</span>.<span class="at">forEach</span>(<span class="kw">function</span> (reply<span class="op">,</span> i) <span class="op">{</span></a>
<a class="sourceLine" id="cb20-16" title="16">    <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;    &#39;</span> <span class="op">+</span> i <span class="op">+</span> <span class="st">&#39;: &#39;</span> <span class="op">+</span> reply)</a>
<a class="sourceLine" id="cb20-17" title="17">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb20-18" title="18"></a>
<a class="sourceLine" id="cb20-19" title="19">  <span class="va">client</span>.<span class="at">quit</span>()</a>
<a class="sourceLine" id="cb20-20" title="20"><span class="op">}</span>)</a></code></pre></div>
<h2 id="sql-server">SQL Server</h2>
<p><strong>Module</strong>: <a href="https://github.com/tediousjs/tedious">tedious</a></p>
<h3 id="installation-10">Installation</h3>
<div class="sourceCode" id="cb21"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" title="1">$ <span class="ex">npm</span> install tedious</a></code></pre></div>
<h3 id="example-10">Example</h3>
<div class="sourceCode" id="cb22"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">var</span> Connection <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;tedious&#39;</span>).<span class="at">Connection</span></a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">var</span> Request <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;tedious&#39;</span>).<span class="at">Request</span></a>
<a class="sourceLine" id="cb22-3" title="3"></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="kw">var</span> config <span class="op">=</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-5" title="5">  <span class="dt">userName</span><span class="op">:</span> <span class="st">&#39;your_username&#39;</span><span class="op">,</span> <span class="co">// update me</span></a>
<a class="sourceLine" id="cb22-6" title="6">  <span class="dt">password</span><span class="op">:</span> <span class="st">&#39;your_password&#39;</span><span class="op">,</span> <span class="co">// update me</span></a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="dt">server</span><span class="op">:</span> <span class="st">&#39;localhost&#39;</span></a>
<a class="sourceLine" id="cb22-8" title="8"><span class="op">}</span></a>
<a class="sourceLine" id="cb22-9" title="9"></a>
<a class="sourceLine" id="cb22-10" title="10"><span class="kw">var</span> connection <span class="op">=</span> <span class="kw">new</span> <span class="at">Connection</span>(config)</a>
<a class="sourceLine" id="cb22-11" title="11"></a>
<a class="sourceLine" id="cb22-12" title="12"><span class="va">connection</span>.<span class="at">on</span>(<span class="st">&#39;connect&#39;</span><span class="op">,</span> <span class="kw">function</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-13" title="13">  <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-14" title="14">    <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb22-15" title="15">  <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-16" title="16">    <span class="at">executeStatement</span>()</a>
<a class="sourceLine" id="cb22-17" title="17">  <span class="op">}</span></a>
<a class="sourceLine" id="cb22-18" title="18"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb22-19" title="19"></a>
<a class="sourceLine" id="cb22-20" title="20"><span class="kw">function</span> <span class="at">executeStatement</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb22-21" title="21">  request <span class="op">=</span> <span class="kw">new</span> <span class="at">Request</span>(<span class="st">&quot;select 123, &#39;hello world&#39;&quot;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> rowCount) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-22" title="22">    <span class="cf">if</span> (err) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-23" title="23">      <span class="va">console</span>.<span class="at">log</span>(err)</a>
<a class="sourceLine" id="cb22-24" title="24">    <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-25" title="25">      <span class="va">console</span>.<span class="at">log</span>(rowCount <span class="op">+</span> <span class="st">&#39; rows&#39;</span>)</a>
<a class="sourceLine" id="cb22-26" title="26">    <span class="op">}</span></a>
<a class="sourceLine" id="cb22-27" title="27">    <span class="va">connection</span>.<span class="at">close</span>()</a>
<a class="sourceLine" id="cb22-28" title="28">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb22-29" title="29"></a>
<a class="sourceLine" id="cb22-30" title="30">  <span class="va">request</span>.<span class="at">on</span>(<span class="st">&#39;row&#39;</span><span class="op">,</span> <span class="kw">function</span> (columns) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-31" title="31">    <span class="va">columns</span>.<span class="at">forEach</span>(<span class="kw">function</span> (column) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-32" title="32">      <span class="cf">if</span> (<span class="va">column</span>.<span class="at">value</span> <span class="op">===</span> <span class="kw">null</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb22-33" title="33">        <span class="va">console</span>.<span class="at">log</span>(<span class="st">&#39;NULL&#39;</span>)</a>
<a class="sourceLine" id="cb22-34" title="34">      <span class="op">}</span> <span class="cf">else</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb22-35" title="35">        <span class="va">console</span>.<span class="at">log</span>(<span class="va">column</span>.<span class="at">value</span>)</a>
<a class="sourceLine" id="cb22-36" title="36">      <span class="op">}</span></a>
<a class="sourceLine" id="cb22-37" title="37">    <span class="op">}</span>)</a>
<a class="sourceLine" id="cb22-38" title="38">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb22-39" title="39"></a>
<a class="sourceLine" id="cb22-40" title="40">  <span class="va">connection</span>.<span class="at">execSql</span>(request)</a>
<a class="sourceLine" id="cb22-41" title="41"><span class="op">}</span></a></code></pre></div>
<h2 id="sqlite">SQLite</h2>
<p><strong>Module</strong>: <a href="https://github.com/mapbox/node-sqlite3">sqlite3</a></p>
<h3 id="installation-11">Installation</h3>
<div class="sourceCode" id="cb23"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb23-1" title="1">$ <span class="ex">npm</span> install sqlite3</a></code></pre></div>
<h3 id="example-11">Example</h3>
<div class="sourceCode" id="cb24"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">var</span> sqlite3 <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;sqlite3&#39;</span>).<span class="at">verbose</span>()</a>
<a class="sourceLine" id="cb24-2" title="2"><span class="kw">var</span> db <span class="op">=</span> <span class="kw">new</span> <span class="va">sqlite3</span>.<span class="at">Database</span>(<span class="st">&#39;:memory:&#39;</span>)</a>
<a class="sourceLine" id="cb24-3" title="3"></a>
<a class="sourceLine" id="cb24-4" title="4"><span class="va">db</span>.<span class="at">serialize</span>(<span class="kw">function</span> () <span class="op">{</span></a>
<a class="sourceLine" id="cb24-5" title="5">  <span class="va">db</span>.<span class="at">run</span>(<span class="st">&#39;CREATE TABLE lorem (info TEXT)&#39;</span>)</a>
<a class="sourceLine" id="cb24-6" title="6">  <span class="kw">var</span> stmt <span class="op">=</span> <span class="va">db</span>.<span class="at">prepare</span>(<span class="st">&#39;INSERT INTO lorem VALUES (?)&#39;</span>)</a>
<a class="sourceLine" id="cb24-7" title="7"></a>
<a class="sourceLine" id="cb24-8" title="8">  <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">10</span><span class="op">;</span> i<span class="op">++</span>) <span class="op">{</span></a>
<a class="sourceLine" id="cb24-9" title="9">    <span class="va">stmt</span>.<span class="at">run</span>(<span class="st">&#39;Ipsum &#39;</span> <span class="op">+</span> i)</a>
<a class="sourceLine" id="cb24-10" title="10">  <span class="op">}</span></a>
<a class="sourceLine" id="cb24-11" title="11"></a>
<a class="sourceLine" id="cb24-12" title="12">  <span class="va">stmt</span>.<span class="at">finalize</span>()</a>
<a class="sourceLine" id="cb24-13" title="13"></a>
<a class="sourceLine" id="cb24-14" title="14">  <span class="va">db</span>.<span class="at">each</span>(<span class="st">&#39;SELECT rowid AS id, info FROM lorem&#39;</span><span class="op">,</span> <span class="kw">function</span> (err<span class="op">,</span> row) <span class="op">{</span></a>
<a class="sourceLine" id="cb24-15" title="15">    <span class="va">console</span>.<span class="at">log</span>(<span class="va">row</span>.<span class="at">id</span> <span class="op">+</span> <span class="st">&#39;: &#39;</span> <span class="op">+</span> <span class="va">row</span>.<span class="at">info</span>)</a>
<a class="sourceLine" id="cb24-16" title="16">  <span class="op">}</span>)</a>
<a class="sourceLine" id="cb24-17" title="17"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb24-18" title="18"></a>
<a class="sourceLine" id="cb24-19" title="19"><span class="va">db</span>.<span class="at">close</span>()</a></code></pre></div>
<h2 id="elasticsearch">ElasticSearch</h2>
<p><strong>Module</strong>: <a href="https://github.com/elastic/elasticsearch-js">elasticsearch</a></p>
<h3 id="installation-12">Installation</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb25-1" title="1">$ <span class="ex">npm</span> install elasticsearch</a></code></pre></div>
<h3 id="example-12">Example</h3>
<div class="sourceCode" id="cb26"><pre class="sourceCode js"><code class="sourceCode javascript"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">var</span> elasticsearch <span class="op">=</span> <span class="at">require</span>(<span class="st">&#39;elasticsearch&#39;</span>)</a>
<a class="sourceLine" id="cb26-2" title="2"><span class="kw">var</span> client <span class="op">=</span> <span class="va">elasticsearch</span>.<span class="at">Client</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb26-3" title="3">  <span class="dt">host</span><span class="op">:</span> <span class="st">&#39;localhost:9200&#39;</span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="op">}</span>)</a>
<a class="sourceLine" id="cb26-5" title="5"></a>
<a class="sourceLine" id="cb26-6" title="6"><span class="va">client</span>.<span class="at">search</span>(<span class="op">{</span></a>
<a class="sourceLine" id="cb26-7" title="7">  <span class="dt">index</span><span class="op">:</span> <span class="st">&#39;books&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb26-8" title="8">  <span class="dt">type</span><span class="op">:</span> <span class="st">&#39;book&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb26-9" title="9">  <span class="dt">body</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-10" title="10">    <span class="dt">query</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-11" title="11">      <span class="dt">multi_match</span><span class="op">:</span> <span class="op">{</span></a>
<a class="sourceLine" id="cb26-12" title="12">        <span class="dt">query</span><span class="op">:</span> <span class="st">&#39;express js&#39;</span><span class="op">,</span></a>
<a class="sourceLine" id="cb26-13" title="13">        <span class="dt">fields</span><span class="op">:</span> [<span class="st">&#39;title&#39;</span><span class="op">,</span> <span class="st">&#39;description&#39;</span>]</a>
<a class="sourceLine" id="cb26-14" title="14">      <span class="op">}</span></a>
<a class="sourceLine" id="cb26-15" title="15">    <span class="op">}</span></a>
<a class="sourceLine" id="cb26-16" title="16">  <span class="op">}</span></a>
<a class="sourceLine" id="cb26-17" title="17"><span class="op">}</span>).<span class="at">then</span>(<span class="kw">function</span> (response) <span class="op">{</span></a>
<a class="sourceLine" id="cb26-18" title="18">  <span class="kw">var</span> hits <span class="op">=</span> <span class="va">response</span>.<span class="va">hits</span>.<span class="at">hits</span></a>
<a class="sourceLine" id="cb26-19" title="19"><span class="op">},</span> <span class="kw">function</span> (error) <span class="op">{</span></a>
<a class="sourceLine" id="cb26-20" title="20">  <span class="va">console</span>.<span class="at">trace</span>(<span class="va">error</span>.<span class="at">message</span>)</a>
<a class="sourceLine" id="cb26-21" title="21"><span class="op">}</span>)</a></code></pre></div>
</body>
</html>
