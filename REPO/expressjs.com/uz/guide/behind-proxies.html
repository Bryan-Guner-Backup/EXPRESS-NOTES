<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="uz" xml:lang="uz">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Express behind proxies</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
</head>
<body>
<header id="title-block-header">
<h1 class="title">Express behind proxies</h1>
</header>
<h1 id="express-behind-proxies">Express behind proxies</h1>
<p>Using Express behind a reverse proxy (such as Varnish or Nginx) is trivial; however, it does require configuration. By enabling the “trust proxy” setting via <code>app.enable('trust proxy')</code>, Express will have knowledge that it’s sitting behind a proxy and that the <code>X-Forwarded-*</code> header fields may be trusted. (Otherwise, they are easily spoofed.)</p>
<p>Enabling this setting has several subtle effects. The first is that <code>X-Forwarded-Proto</code> may be set by the reverse proxy to tell the app whether it is https or simply http. This value is reflected by <a href="/api.html#req.protocol">req.protocol</a>.</p>
<p>The second change is that the <a href="/api.html#req.ip">req.ip</a> and <a href="/api.html#req.ips">req.ips</a> values will be populated with <code>X-Forwarded-For</code>’s list of addresses.</p>
</body>
</html>
